<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A quick tour of clustvarsel â€¢ clustvarsel</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="A quick tour of clustvarsel">
<meta property="og:description" content="clustvarsel">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">clustvarsel</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/clustvarsel.html">Vignette</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://mclust-org.github.io">
    <span class="fas fa-home"></span>
     
    mclust-org
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="clustvarsel_files/header-attrs-2.6/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>A quick tour of clustvarsel</h1>
                        <h4 class="author">Luca Scrucca</h4>
            
            <h4 class="date">16 Dec 2020</h4>
      
      
      <div class="hidden name"><code>clustvarsel.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The <strong>clustvarsel</strong> package implements variable selection methodology for Gaussian model-based clustering which allows to find the (locally) optimal subset of variables in a dataset that have group/cluster information. A greedy or headlong search can be used, either in a forward-backward or backward-forward direction, with or without sub-sampling at the hierarchical clustering stage for starting <strong>mclust</strong> models. By default the algorithm uses a sequential search, but parallelisation is also available.</p>
<p>This document gives a quick tour of <strong>clustvarsel</strong> (version 2.3.4) functionalities. It was written in R Markdown, using the <a href="https://cran.r-project.org/package=knitr">knitr</a> package for production. See <code><a href="https://rdrr.io/pkg/clustvarsel/man">help(package="clustvarsel")</a></code> for further details and references provided by <code><a href="https://rdrr.io/r/utils/citation.html">citation("clustvarsel")</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mclust-org.github.io/mclust/">mclust</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">clustvarsel</span><span class="op">)</span></code></pre></div>
</div>
<div id="simulated-clustering-data-example" class="section level1">
<h1 class="hasAnchor">
<a href="#simulated-clustering-data-example" class="anchor"></a>Simulated clustering data example</h1>
<p>In this example we simulate a dataset on five dimensions with only the first two variables contain clustering information, the third being highly correlated with the first one, and the remaining features which are simply noise variables.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span>      <span class="co"># sample size</span>
<span class="va">pro</span> <span class="op">&lt;-</span> <span class="fl">0.5</span>    <span class="co"># mixing proportion</span>
<span class="va">mu1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span> <span class="co"># mean vector for the first cluster</span>
<span class="va">mu2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span> <span class="co"># mean vector for the second cluster</span>
<span class="va">sigma1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>       <span class="co"># covar matrix for the first cluster</span>
<span class="va">sigma2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="op">-</span><span class="fl">0.7</span>,<span class="op">-</span><span class="fl">0.7</span>,<span class="fl">1.5</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span> <span class="co"># covar matrix for the second cluster</span>
<span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span>, <span class="fl">5</span>, dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="cn">NULL</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span> <span class="co"># for replication</span>
<span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="va">Class</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">u</span> <span class="op">&lt;</span> <span class="va">pro</span>, <span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>
<span class="va">X</span><span class="op">[</span><span class="va">u</span> <span class="op">&lt;</span> <span class="va">pro</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>  <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">u</span> <span class="op">&lt;</span> <span class="va">pro</span><span class="op">)</span>, mu <span class="op">=</span> <span class="va">mu1</span>, Sigma <span class="op">=</span> <span class="va">sigma1</span><span class="op">)</span>
<span class="va">X</span><span class="op">[</span><span class="va">u</span> <span class="op">&gt;=</span> <span class="va">pro</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="va">u</span> <span class="op">&gt;=</span> <span class="va">pro</span><span class="op">)</span>, mu <span class="op">=</span> <span class="va">mu2</span>, Sigma <span class="op">=</span> <span class="va">sigma2</span><span class="op">)</span>
<span class="va">X</span><span class="op">[</span>, <span class="fl">3</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">X</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span>
<span class="va">X</span><span class="op">[</span>, <span class="fl">4</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">1.5</span>, sd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="va">X</span><span class="op">[</span>, <span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="va">n</span>, mean <span class="op">=</span> <span class="fl">2</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>
<span class="fu"><a href="https://mclust-org.github.io/mclust/reference/clPairs.html">clPairs</a></span><span class="op">(</span><span class="va">X</span>, <span class="va">Class</span><span class="op">)</span></code></pre></div>
<p><img src="clustvarsel_files/figure-html/unnamed-chunk-2-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clustvarsel.html">clustvarsel</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>
<span class="co">## iter 1</span>
<span class="co">## + adding step</span>
<span class="co">##   Var  BICdiff Step Decision</span>
<span class="co">## 1  X2 11.17931  Add Accepted</span>
<span class="co">## iter 2</span>
<span class="co">## + adding step</span>
<span class="co">##   Var BICdiff Step Decision</span>
<span class="co">## 2  X1 85.1953  Add Accepted</span>
<span class="co">## iter 3 </span>
<span class="co">## + adding step</span>
<span class="co">## - removing step</span>
<span class="co">##   Var   BICdiff   Step Decision</span>
<span class="co">## 3  X3 -14.91130    Add Rejected</span>
<span class="co">## 4  X1  85.19104 Remove Rejected</span>
<span class="co">## final iter</span>
<span class="co">## * fitting model on selected subset</span>

<span class="va">out</span>
<span class="co">## ------------------------------------------------------ </span>
<span class="co">## Variable selection for Gaussian model-based clustering</span>
<span class="co">## Stepwise (forward/backward) greedy search</span>
<span class="co">## ------------------------------------------------------ </span>
<span class="co">## </span>
<span class="co">##  Variable proposed Type of step   BICclust Model G   BICdiff Decision</span>
<span class="co">##                 X2          Add  -822.6398     E 2  11.17931 Accepted</span>
<span class="co">##                 X1          Add -1482.8408   VEV 2  85.19530 Accepted</span>
<span class="co">##                 X3          Add -2047.7064   EEV 2 -14.91130 Rejected</span>
<span class="co">##                 X1       Remove  -822.6355     E 2  85.19104 Rejected</span>
<span class="co">## </span>
<span class="co">## Selected subset: X2, X1</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">model</span><span class="op">)</span>
<span class="co">## ---------------------------------------------------- </span>
<span class="co">## Gaussian finite mixture model fitted by EM algorithm </span>
<span class="co">## ---------------------------------------------------- </span>
<span class="co">## </span>
<span class="co">## Mclust VEV (ellipsoidal, equal shape) model with 2 components: </span>
<span class="co">## </span>
<span class="co">##  log.likelihood   n df       BIC       ICL</span>
<span class="co">##       -714.9288 200 10 -1482.841 -1493.898</span>
<span class="co">## </span>
<span class="co">## Clustering table:</span>
<span class="co">##   1   2 </span>
<span class="co">##  99 101 </span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clustvarsel.html">clustvarsel</a></span><span class="op">(</span><span class="va">X</span>, direction <span class="op">=</span> <span class="st">"backward"</span>, fit <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="co">## iter 1 </span>
<span class="co">## - removing step</span>
<span class="co">##   Var   BICdiff   Step Decision</span>
<span class="co">## 1  X3 -38.09195 Remove Accepted</span>
<span class="co">## iter 2 </span>
<span class="co">## - removing step</span>
<span class="co">##   Var   BICdiff   Step Decision</span>
<span class="co">## 2  X4 -23.50212 Remove Accepted</span>
<span class="co">## iter 3 </span>
<span class="co">## - removing step</span>
<span class="co">## + adding step</span>
<span class="co">##   Var   BICdiff   Step Decision</span>
<span class="co">## 3  X5 -16.25831 Remove Accepted</span>
<span class="co">## 4  X3 -14.91130    Add Rejected</span>
<span class="co">## iter 4 </span>
<span class="co">## - removing step</span>
<span class="co">## + adding step</span>
<span class="co">##   Var   BICdiff   Step Decision</span>
<span class="co">## 5  X1  95.55735 Remove Rejected</span>
<span class="co">## 6  X3 -14.91130    Add Rejected</span>

<span class="va">out</span>
<span class="co">## ------------------------------------------------------ </span>
<span class="co">## Variable selection for Gaussian model-based clustering</span>
<span class="co">## Stepwise (backward/forward) greedy search</span>
<span class="co">## ------------------------------------------------------ </span>
<span class="co">## </span>
<span class="co">##  Variable proposed Type of step   BICclust Model G   BICdiff Decision</span>
<span class="co">##                 X3       Remove -2925.4851   EVE 2 -38.09195 Accepted</span>
<span class="co">##                 X4       Remove -2067.0668   EVE 2 -23.50212 Accepted</span>
<span class="co">##                 X5       Remove -1482.8408   VEV 2 -16.25831 Accepted</span>
<span class="co">##                 X3          Add -2047.7064   EEV 2 -14.91130 Rejected</span>
<span class="co">##                 X1       Remove  -833.0019     V 2  95.55735 Rejected</span>
<span class="co">##                 X3          Add -2047.7064   EEV 2 -14.91130 Rejected</span>
<span class="co">## </span>
<span class="co">## Selected subset: X1, X2</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clustvarsel.html">clustvarsel</a></span><span class="op">(</span><span class="va">X</span>, search <span class="op">=</span> <span class="st">"headlong"</span><span class="op">)</span>
<span class="co">## iter 1</span>
<span class="co">## + adding step</span>
<span class="co">##   Var  BICdiff Step Decision</span>
<span class="co">## 1  X2 11.17931  Add Accepted</span>
<span class="co">## iter 2</span>
<span class="co">## + adding step</span>
<span class="co">##   Var BICdiff Step Decision</span>
<span class="co">## 2  X1 85.1953  Add Accepted</span>
<span class="co">## iter 3 </span>
<span class="co">## + adding step</span>
<span class="co">## - removing step</span>
<span class="co">##   Var  BICdiff   Step Decision</span>
<span class="co">## 3  X3 -14.9113    Add Rejected</span>
<span class="co">## 4  X1  85.1953 Remove Rejected</span>
<span class="co">## final iter</span>
<span class="co">## * fitting model on selected subset</span>

<span class="va">out</span>
<span class="co">## ------------------------------------------------------ </span>
<span class="co">## Variable selection for Gaussian model-based clustering</span>
<span class="co">## Headlong (forward/backward) search</span>
<span class="co">## ------------------------------------------------------ </span>
<span class="co">## </span>
<span class="co">##  Variable proposed Type of step   BICclust Model G   BICdiff Decision</span>
<span class="co">##                 X2          Add  -822.6398     E 2  11.17931 Accepted</span>
<span class="co">##                 X1          Add -1482.8408   VEV 2  85.19530 Accepted</span>
<span class="co">##                 X3          Add -2047.7064   EEV 2 -14.91130 Rejected</span>
<span class="co">##                 X1       Remove  -822.6398     E 2  85.19530 Rejected</span>
<span class="co">## </span>
<span class="co">## Selected subset: X2, X1</span></code></pre></div>
</div>
<div id="simulated-no-clustering-data-example" class="section level1">
<h1 class="hasAnchor">
<a href="#simulated-no-clustering-data-example" class="anchor"></a>Simulated no-clustering data example</h1>
<p>In this example we simulate a dataset on ten dimensions with no clustering. It is shown that model-based clustering on all the variables yield the wrong conclusion that 2 clusters are present, but after subset selection the Gaussian finite mixture model correctly select a single cluster solution.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span>
<span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">10</span>
<span class="va">mu</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">p</span><span class="op">)</span>
<span class="va">sigma1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>
<span class="va">sigma2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1.5</span>,<span class="op">-</span><span class="fl">0.7</span>,<span class="op">-</span><span class="fl">0.7</span>,<span class="fl">1.5</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span>
<span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu">Matrix</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Matrix/man/bdiag.html">bdiag</a></span><span class="op">(</span><span class="va">sigma1</span>, <span class="va">sigma2</span>, <span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span>
<span class="va">X</span> <span class="op">&lt;-</span> <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/mvrnorm.html">mvrnorm</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">mu</span>, <span class="va">sigma</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"X"</span>, <span class="fl">1</span><span class="op">:</span><span class="va">p</span><span class="op">)</span>
<span class="fu"><a href="https://mclust-org.github.io/mclust/reference/clPairs.html">clPairs</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span></code></pre></div>
<p><img src="clustvarsel_files/figure-html/unnamed-chunk-6-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>Model-based clustering on all the available variables:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mclust-org.github.io/mclust/reference/Mclust.html">Mclust</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span>
<span class="co">## Best BIC values:</span>
<span class="co">##              EII,2       VII,2       EII,3</span>
<span class="co">## BIC      -5899.073 -5901.88582 -5922.53452</span>
<span class="co">## BIC diff     0.000    -2.81261   -23.46131</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">mod</span><span class="op">)</span>
<span class="co">## ----------------------------------------------------</span>
<span class="co">## Gaussian finite mixture model fitted by EM algorithm </span>
<span class="co">## ----------------------------------------------------</span>
<span class="co">## </span>
<span class="co">## Mclust EII (spherical, equal volume) model with 2 components:</span>
<span class="co">## </span>
<span class="co">##  log.likelihood   n df       BIC       ICL</span>
<span class="co">##       -2891.255 200 22 -5899.073 -5953.953</span>
<span class="co">## </span>
<span class="co">## Clustering table:</span>
<span class="co">##   1   2 </span>
<span class="co">##  90 110</span></code></pre></div>
<p>Subset selection using forward/backward greedy algorithm:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">out1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clustvarsel.html">clustvarsel</a></span><span class="op">(</span><span class="va">X</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
<span class="co">## ------------------------------------------------------ </span>
<span class="co">## Variable selection for Gaussian model-based clustering</span>
<span class="co">## Stepwise (forward/backward) greedy search</span>
<span class="co">## ------------------------------------------------------ </span>
<span class="co">## </span>
<span class="co">##  Variable proposed Type of step   BICclust Model G    BICdiff Decision</span>
<span class="co">##                 X3          Add  -666.9232     E 2 -4.8472740 Accepted</span>
<span class="co">##                 X7          Add -1242.8998   EII 2  1.5678544 Accepted</span>
<span class="co">##                X10          Add -1814.8848   EII 2  1.5172709 Accepted</span>
<span class="co">##                X10       Remove -1242.8998   EII 2  1.5172709 Rejected</span>
<span class="co">##                 X6          Add -2390.3224   EII 2  0.6539224 Accepted</span>
<span class="co">##                 X6       Remove -1814.8848   EII 2  0.6539224 Rejected</span>
<span class="co">##                 X2          Add -2942.2744   EII 2  0.1214452 Accepted</span>
<span class="co">##                 X2       Remove -2390.3224   EII 2  0.1214452 Rejected</span>
<span class="co">##                 X8          Add -3495.9758   EII 2  0.1104619 Accepted</span>
<span class="co">##                 X8       Remove -2942.2744   EII 2  0.1104619 Rejected</span>
<span class="co">##                 X9          Add -4081.9212   EII 2 -2.0296117 Rejected</span>
<span class="co">##                 X8       Remove -2942.2744   EII 2  0.1104619 Rejected</span>
<span class="co">## </span>
<span class="co">## Selected subset: X3, X7, X10, X6, X2, X8</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">out1</span><span class="op">$</span><span class="va">model</span><span class="op">)</span>
<span class="co"># or</span>
<span class="co"># mod1 &lt;- Mclust(X[,out1$subset])</span>
<span class="co"># summary(mod1)</span>
<span class="co">## ----------------------------------------------------</span>
<span class="co">## Gaussian finite mixture model fitted by EM algorithm </span>
<span class="co">## ----------------------------------------------------</span>
<span class="co">## </span>
<span class="co">## Mclust XII (spherical multivariate normal) model with 1 component:</span>
<span class="co">## </span>
<span class="co">##  log.likelihood   n df       BIC       ICL</span>
<span class="co">##       -1727.188 200  7 -3491.465 -3491.465</span>
<span class="co">## </span>
<span class="co">## Clustering table:</span>
<span class="co">##   1 </span>
<span class="co">## 200</span></code></pre></div>
<p>Note that the final clustering model shown in the <code><a href="../reference/clustvarsel.html">clustvarsel()</a></code> output is EII with 2 mixture components. However, this model has been constrained to have G <span class="math inline">\(\ge\)</span> 2 components because it must be a clustering model. When the final model is fitted on the selected variables without imposing the constraint on G, the BIC correctly indicates a single component model.</p>
<p>Subset selection using backward/forward greedy algorithm:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="op">(</span><span class="va">out2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/clustvarsel.html">clustvarsel</a></span><span class="op">(</span><span class="va">X</span>, direction <span class="op">=</span> <span class="st">"backward"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span>
<span class="co">## ------------------------------------------------------ </span>
<span class="co">## Variable selection for Gaussian model-based clustering</span>
<span class="co">## Stepwise (backward/forward) greedy search</span>
<span class="co">## ------------------------------------------------------ </span>
<span class="co">## </span>
<span class="co">##  Variable proposed Type of step  BICclust Model G     BICdiff Decision</span>
<span class="co">##                 X2       Remove -5346.204   EII 2 -48.0289667 Accepted</span>
<span class="co">##                 X4       Remove -4696.525   EII 2  -7.1909995 Accepted</span>
<span class="co">##                 X3       Remove -4032.114   EII 2  -2.3352781 Accepted</span>
<span class="co">##                 X3          Add -4696.525   EII 2  -2.3352781 Rejected</span>
<span class="co">##                 X7       Remove -3453.786   EII 2  -1.1967844 Accepted</span>
<span class="co">##                 X7          Add -4032.114   EII 2  -1.1967844 Rejected</span>
<span class="co">##                 X8       Remove -2899.545   EII 2  -0.4288443 Accepted</span>
<span class="co">##                 X8          Add -3453.786   EII 2  -0.4288443 Rejected</span>
<span class="co">##                 X5       Remove -2308.785   EII 2   1.0712786 Rejected</span>
<span class="co">##                 X8          Add -3453.786   EII 2  -0.4288443 Rejected</span>
<span class="co">## </span>
<span class="co">## Selected subset: X1, X5, X6, X9, X10</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">out2</span><span class="op">$</span><span class="va">model</span><span class="op">)</span>
<span class="co">## ----------------------------------------------------</span>
<span class="co">## Gaussian finite mixture model fitted by EM algorithm </span>
<span class="co">## ----------------------------------------------------</span>
<span class="co">## </span>
<span class="co">## Mclust XII (spherical multivariate normal) model with 1 component:</span>
<span class="co">## </span>
<span class="co">##  log.likelihood   n df       BIC       ICL</span>
<span class="co">##       -1424.072 200  6 -2879.934 -2879.934</span>
<span class="co">## </span>
<span class="co">## Clustering table:</span>
<span class="co">##   1 </span>
<span class="co">## 200</span></code></pre></div>
<p>Although the selected subset of variables is different from that obtained using forward greedy search, the same comments outlined previously apply here too.</p>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>Raftery, A. E. and Dean, N. (2006) Variable Selection for Model-Based Clustering. <em>Journal of the American Statistical Association</em>, 101(473), 168-178.</p>
<p>Maugis, C., Celeux, G., Martin-Magniette M. (2009) Variable Selection for Clustering With Gaussian Mixture Models. <em>Biometrics</em>, 65(3), 701-709.</p>
<p>Scrucca, L. and Raftery, A. E. (2018) clustvarsel: A Package Implementing Variable Selection for Gaussian Model-based Clustering in R. <em>Journal of Statistical Software</em>, 84(1), pp.Â 1-28.</p>
<hr>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">## R version 4.0.3 (2020-10-10)</span>
<span class="co">## Platform: x86_64-apple-darwin17.0 (64-bit)</span>
<span class="co">## Running under: macOS Big Sur 10.16</span>
<span class="co">## </span>
<span class="co">## Matrix products: default</span>
<span class="co">## BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib</span>
<span class="co">## LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib</span>
<span class="co">## </span>
<span class="co">## locale:</span>
<span class="co">## [1] en_US.UTF-8/UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8</span>
<span class="co">## </span>
<span class="co">## attached base packages:</span>
<span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span>
<span class="co">## </span>
<span class="co">## other attached packages:</span>
<span class="co">## [1] clustvarsel_2.3.4 mclust_5.4.8      knitr_1.30       </span>
<span class="co">## </span>
<span class="co">## loaded via a namespace (and not attached):</span>
<span class="co">##  [1] magrittr_2.0.1    MASS_7.3-53       leaps_3.1         splines_4.0.3    </span>
<span class="co">##  [5] lattice_0.20-41   rrcov_1.5-5       R6_2.5.0          rlang_0.4.9      </span>
<span class="co">##  [9] pcaPP_1.9-73      foreach_1.5.1     stringr_1.4.0     tools_4.0.3      </span>
<span class="co">## [13] grid_4.0.3        xfun_0.19         htmltools_0.5.0   iterators_1.0.13 </span>
<span class="co">## [17] yaml_2.2.1        survival_3.2-7    assertthat_0.2.1  rprojroot_2.0.2  </span>
<span class="co">## [21] digest_0.6.27     pkgdown_1.6.1     crayon_1.3.4      Matrix_1.2-18    </span>
<span class="co">## [25] fs_1.5.0          codetools_0.2-18  inline_0.3.17     robustbase_0.93-6</span>
<span class="co">## [29] memoise_1.1.0     evaluate_0.14     rmarkdown_2.6     stringi_1.5.3    </span>
<span class="co">## [33] BMA_3.18.14       DEoptimR_1.0-8    compiler_4.0.3    desc_1.2.0       </span>
<span class="co">## [37] stats4_4.0.3      mvtnorm_1.1-1</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Nema Dean, Adrian E. Raftery, <a href="http://www.stat.unipg.it/luca">Luca Scrucca</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
