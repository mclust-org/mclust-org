<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A quick tour of clustvarsel â€¢ clustvarsel</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="A quick tour of clustvarsel">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">clustvarsel</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">2.3.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/index.html">Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    mclust-org packages
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="http://www.stat.unipg.it/luca/mclust-org/mclust">mclust</a>
    </li>
    <li>
      <a href="http://www.stat.unipg.it/luca/mclust-org/clustvarsel">clustvarsel</a>
    </li>
  </ul>
</li>
<li>
  <a href="http://www.stat.unipg.it/luca/mclust-org">
    <span class="fa fa-home"></span>
     
    mclust-org
  </a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>A quick tour of clustvarsel</h1>
                        <h4 class="author">Luca Scrucca</h4>
            
            <h4 class="date">27 Nov 2018</h4>
      
      
      <div class="hidden name"><code>clustvarsel.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The <strong>clustvarsel</strong> package implements variable selection methodology for Gaussian model-based clustering which allows to find the (locally) optimal subset of variables in a dataset that have group/cluster information. A greedy or headlong search can be used, either in a forward-backward or backward-forward direction, with or without sub-sampling at the hierarchical clustering stage for starting <strong>mclust</strong> models. By default the algorithm uses a sequential search, but parallelisation is also available.</p>
<p>This document gives a quick tour of <strong>clustvarsel</strong> (version 2.3.3) functionalities. It was written in R Markdown, using the <a href="https://cran.r-project.org/package=knitr">knitr</a> package for production. See <code>help(package="clustvarsel")</code> for further details and references provided by <code>citation("clustvarsel")</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(mclust)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(clustvarsel)</a></code></pre></div>
</div>
<div id="simulated-clustering-data-example" class="section level2">
<h2 class="hasAnchor">
<a href="#simulated-clustering-data-example" class="anchor"></a>Simulated clustering data example</h2>
<p>In this example we simulate a dataset on five dimensions with only the first two variables contain clustering information, the third being highly correlated with the first one, and the remaining features which are simply noise variables.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">n &lt;-<span class="st"> </span><span class="dv">200</span>      <span class="co"># sample size</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2">pro &lt;-<span class="st"> </span><span class="fl">0.5</span>    <span class="co"># mixing proportion</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">mu1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>) <span class="co"># mean vector for the first cluster</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">mu2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>) <span class="co"># mean vector for the second cluster</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">sigma1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)       <span class="co"># covar matrix for the first cluster</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">sigma2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">1.5</span>,<span class="op">-</span><span class="fl">0.7</span>,<span class="op">-</span><span class="fl">0.7</span>,<span class="fl">1.5</span>),<span class="dv">2</span>,<span class="dv">2</span>) <span class="co"># covar matrix for the second cluster</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, n, <span class="dv">5</span>, <span class="dt">dimnames =</span> <span class="kw">list</span>(<span class="ot">NULL</span>, <span class="kw">paste0</span>(<span class="st">"X"</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)))</a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="kw">set.seed</span>(<span class="dv">1234</span>) <span class="co"># for replication</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">u &lt;-<span class="st"> </span><span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb2-10" data-line-number="10">Class &lt;-<span class="st"> </span><span class="kw">ifelse</span>(u <span class="op">&lt;</span><span class="st"> </span>pro, <span class="dv">1</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb2-11" data-line-number="11">X[u <span class="op">&lt;</span><span class="st"> </span>pro, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]  &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/MASS/topics/mvrnorm">mvrnorm</a></span>(<span class="kw">sum</span>(u <span class="op">&lt;</span><span class="st"> </span>pro), <span class="dt">mu =</span> mu1, <span class="dt">Sigma =</span> sigma1)</a>
<a class="sourceLine" id="cb2-12" data-line-number="12">X[u <span class="op">&gt;=</span><span class="st"> </span>pro, <span class="dv">1</span><span class="op">:</span><span class="dv">2</span>] &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/MASS/topics/mvrnorm">mvrnorm</a></span>(<span class="kw">sum</span>(u <span class="op">&gt;=</span><span class="st"> </span>pro), <span class="dt">mu =</span> mu2, <span class="dt">Sigma =</span> sigma2)</a>
<a class="sourceLine" id="cb2-13" data-line-number="13">X[, <span class="dv">3</span>] &lt;-<span class="st"> </span>X[, <span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n)</a>
<a class="sourceLine" id="cb2-14" data-line-number="14">X[, <span class="dv">4</span>] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean =</span> <span class="fl">1.5</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb2-15" data-line-number="15">X[, <span class="dv">5</span>] &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">mean =</span> <span class="dv">2</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="kw"><a href="http://www.rdocumentation.org/packages/mclust/topics/clPairs">clPairs</a></span>(X, Class)</a></code></pre></div>
<p><img src="clustvarsel_files/figure-html/unnamed-chunk-2-1.png" width="90%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/clustvarsel.html">clustvarsel</a></span>(X)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="co">## iter 1</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">## + adding step</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="co">##   Var  BICdiff Step Decision</span></a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">## 1  X2 11.17931  Add Accepted</span></a>
<a class="sourceLine" id="cb3-6" data-line-number="6"><span class="co">## iter 2</span></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="co">## + adding step</span></a>
<a class="sourceLine" id="cb3-8" data-line-number="8"><span class="co">##   Var BICdiff Step Decision</span></a>
<a class="sourceLine" id="cb3-9" data-line-number="9"><span class="co">## 2  X1 85.1953  Add Accepted</span></a>
<a class="sourceLine" id="cb3-10" data-line-number="10"><span class="co">## iter 3 </span></a>
<a class="sourceLine" id="cb3-11" data-line-number="11"><span class="co">## + adding step</span></a>
<a class="sourceLine" id="cb3-12" data-line-number="12"><span class="co">## - removing step</span></a>
<a class="sourceLine" id="cb3-13" data-line-number="13"><span class="co">##   Var   BICdiff   Step Decision</span></a>
<a class="sourceLine" id="cb3-14" data-line-number="14"><span class="co">## 3  X3 -14.91130    Add Rejected</span></a>
<a class="sourceLine" id="cb3-15" data-line-number="15"><span class="co">## 4  X1  85.19104 Remove Rejected</span></a>
<a class="sourceLine" id="cb3-16" data-line-number="16"><span class="co">## final iter</span></a>
<a class="sourceLine" id="cb3-17" data-line-number="17"><span class="co">## * fitting model on selected subset</span></a>
<a class="sourceLine" id="cb3-18" data-line-number="18"></a>
<a class="sourceLine" id="cb3-19" data-line-number="19">out</a>
<a class="sourceLine" id="cb3-20" data-line-number="20"><span class="co">## ------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb3-21" data-line-number="21"><span class="co">## Variable selection for Gaussian model-based clustering</span></a>
<a class="sourceLine" id="cb3-22" data-line-number="22"><span class="co">## Stepwise (forward/backward) greedy search</span></a>
<a class="sourceLine" id="cb3-23" data-line-number="23"><span class="co">## ------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb3-24" data-line-number="24"><span class="co">## </span></a>
<a class="sourceLine" id="cb3-25" data-line-number="25"><span class="co">##  Variable proposed Type of step   BICclust Model G   BICdiff Decision</span></a>
<a class="sourceLine" id="cb3-26" data-line-number="26"><span class="co">##                 X2          Add  -822.6398     E 2  11.17931 Accepted</span></a>
<a class="sourceLine" id="cb3-27" data-line-number="27"><span class="co">##                 X1          Add -1482.8408   VEV 2  85.19530 Accepted</span></a>
<a class="sourceLine" id="cb3-28" data-line-number="28"><span class="co">##                 X3          Add -2047.7064   EEV 2 -14.91130 Rejected</span></a>
<a class="sourceLine" id="cb3-29" data-line-number="29"><span class="co">##                 X1       Remove  -822.6355     E 2  85.19104 Rejected</span></a>
<a class="sourceLine" id="cb3-30" data-line-number="30"><span class="co">## </span></a>
<a class="sourceLine" id="cb3-31" data-line-number="31"><span class="co">## Selected subset: X2, X1</span></a>
<a class="sourceLine" id="cb3-32" data-line-number="32"></a>
<a class="sourceLine" id="cb3-33" data-line-number="33"><span class="kw">summary</span>(out<span class="op">$</span>model)</a>
<a class="sourceLine" id="cb3-34" data-line-number="34"><span class="co">## ---------------------------------------------------- </span></a>
<a class="sourceLine" id="cb3-35" data-line-number="35"><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></a>
<a class="sourceLine" id="cb3-36" data-line-number="36"><span class="co">## ---------------------------------------------------- </span></a>
<a class="sourceLine" id="cb3-37" data-line-number="37"><span class="co">## </span></a>
<a class="sourceLine" id="cb3-38" data-line-number="38"><span class="co">## Mclust VEV (ellipsoidal, equal shape) model with 2 components: </span></a>
<a class="sourceLine" id="cb3-39" data-line-number="39"><span class="co">## </span></a>
<a class="sourceLine" id="cb3-40" data-line-number="40"><span class="co">##  log.likelihood   n df       BIC       ICL</span></a>
<a class="sourceLine" id="cb3-41" data-line-number="41"><span class="co">##       -714.9288 200 10 -1482.841 -1493.898</span></a>
<a class="sourceLine" id="cb3-42" data-line-number="42"><span class="co">## </span></a>
<a class="sourceLine" id="cb3-43" data-line-number="43"><span class="co">## Clustering table:</span></a>
<a class="sourceLine" id="cb3-44" data-line-number="44"><span class="co">##   1   2 </span></a>
<a class="sourceLine" id="cb3-45" data-line-number="45"><span class="co">##  99 101 </span></a></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/clustvarsel.html">clustvarsel</a></span>(X, <span class="dt">direction =</span> <span class="st">"backward"</span>, <span class="dt">fit =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">## iter 1 </span></a>
<a class="sourceLine" id="cb4-3" data-line-number="3"><span class="co">## - removing step</span></a>
<a class="sourceLine" id="cb4-4" data-line-number="4"><span class="co">##   Var   BICdiff   Step Decision</span></a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="co">## 1  X3 -38.09195 Remove Accepted</span></a>
<a class="sourceLine" id="cb4-6" data-line-number="6"><span class="co">## iter 2 </span></a>
<a class="sourceLine" id="cb4-7" data-line-number="7"><span class="co">## - removing step</span></a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="co">##   Var   BICdiff   Step Decision</span></a>
<a class="sourceLine" id="cb4-9" data-line-number="9"><span class="co">## 2  X4 -23.50212 Remove Accepted</span></a>
<a class="sourceLine" id="cb4-10" data-line-number="10"><span class="co">## iter 3 </span></a>
<a class="sourceLine" id="cb4-11" data-line-number="11"><span class="co">## - removing step</span></a>
<a class="sourceLine" id="cb4-12" data-line-number="12"><span class="co">## + adding step</span></a>
<a class="sourceLine" id="cb4-13" data-line-number="13"><span class="co">##   Var   BICdiff   Step Decision</span></a>
<a class="sourceLine" id="cb4-14" data-line-number="14"><span class="co">## 3  X5 -16.25831 Remove Accepted</span></a>
<a class="sourceLine" id="cb4-15" data-line-number="15"><span class="co">## 4  X3 -14.91130    Add Rejected</span></a>
<a class="sourceLine" id="cb4-16" data-line-number="16"><span class="co">## iter 4 </span></a>
<a class="sourceLine" id="cb4-17" data-line-number="17"><span class="co">## - removing step</span></a>
<a class="sourceLine" id="cb4-18" data-line-number="18"><span class="co">## + adding step</span></a>
<a class="sourceLine" id="cb4-19" data-line-number="19"><span class="co">##   Var   BICdiff   Step Decision</span></a>
<a class="sourceLine" id="cb4-20" data-line-number="20"><span class="co">## 5  X1  95.55735 Remove Rejected</span></a>
<a class="sourceLine" id="cb4-21" data-line-number="21"><span class="co">## 6  X3 -14.91130    Add Rejected</span></a>
<a class="sourceLine" id="cb4-22" data-line-number="22"></a>
<a class="sourceLine" id="cb4-23" data-line-number="23">out</a>
<a class="sourceLine" id="cb4-24" data-line-number="24"><span class="co">## ------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb4-25" data-line-number="25"><span class="co">## Variable selection for Gaussian model-based clustering</span></a>
<a class="sourceLine" id="cb4-26" data-line-number="26"><span class="co">## Stepwise (backward/forward) greedy search</span></a>
<a class="sourceLine" id="cb4-27" data-line-number="27"><span class="co">## ------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb4-28" data-line-number="28"><span class="co">## </span></a>
<a class="sourceLine" id="cb4-29" data-line-number="29"><span class="co">##  Variable proposed Type of step   BICclust Model G   BICdiff Decision</span></a>
<a class="sourceLine" id="cb4-30" data-line-number="30"><span class="co">##                 X3       Remove -2925.4851   EVE 2 -38.09195 Accepted</span></a>
<a class="sourceLine" id="cb4-31" data-line-number="31"><span class="co">##                 X4       Remove -2067.0668   EVE 2 -23.50212 Accepted</span></a>
<a class="sourceLine" id="cb4-32" data-line-number="32"><span class="co">##                 X5       Remove -1482.8408   VEV 2 -16.25831 Accepted</span></a>
<a class="sourceLine" id="cb4-33" data-line-number="33"><span class="co">##                 X3          Add -2047.7064   EEV 2 -14.91130 Rejected</span></a>
<a class="sourceLine" id="cb4-34" data-line-number="34"><span class="co">##                 X1       Remove  -833.0019     V 2  95.55735 Rejected</span></a>
<a class="sourceLine" id="cb4-35" data-line-number="35"><span class="co">##                 X3          Add -2047.7064   EEV 2 -14.91130 Rejected</span></a>
<a class="sourceLine" id="cb4-36" data-line-number="36"><span class="co">## </span></a>
<a class="sourceLine" id="cb4-37" data-line-number="37"><span class="co">## Selected subset: X1, X2</span></a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">out &lt;-<span class="st"> </span><span class="kw"><a href="../reference/clustvarsel.html">clustvarsel</a></span>(X, <span class="dt">search =</span> <span class="st">"headlong"</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">## iter 1</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">## + adding step</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">##   Var  BICdiff Step Decision</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">## 1  X2 11.17931  Add Accepted</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">## iter 2</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">## + adding step</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">##   Var BICdiff Step Decision</span></a>
<a class="sourceLine" id="cb5-9" data-line-number="9"><span class="co">## 2  X1 85.1953  Add Accepted</span></a>
<a class="sourceLine" id="cb5-10" data-line-number="10"><span class="co">## iter 3 </span></a>
<a class="sourceLine" id="cb5-11" data-line-number="11"><span class="co">## + adding step</span></a>
<a class="sourceLine" id="cb5-12" data-line-number="12"><span class="co">## - removing step</span></a>
<a class="sourceLine" id="cb5-13" data-line-number="13"><span class="co">##   Var  BICdiff   Step Decision</span></a>
<a class="sourceLine" id="cb5-14" data-line-number="14"><span class="co">## 3  X3 -14.9113    Add Rejected</span></a>
<a class="sourceLine" id="cb5-15" data-line-number="15"><span class="co">## 4  X1  85.1953 Remove Rejected</span></a>
<a class="sourceLine" id="cb5-16" data-line-number="16"><span class="co">## final iter</span></a>
<a class="sourceLine" id="cb5-17" data-line-number="17"><span class="co">## * fitting model on selected subset</span></a>
<a class="sourceLine" id="cb5-18" data-line-number="18"></a>
<a class="sourceLine" id="cb5-19" data-line-number="19">out</a>
<a class="sourceLine" id="cb5-20" data-line-number="20"><span class="co">## ------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb5-21" data-line-number="21"><span class="co">## Variable selection for Gaussian model-based clustering</span></a>
<a class="sourceLine" id="cb5-22" data-line-number="22"><span class="co">## Headlong (forward/backward) search</span></a>
<a class="sourceLine" id="cb5-23" data-line-number="23"><span class="co">## ------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb5-24" data-line-number="24"><span class="co">## </span></a>
<a class="sourceLine" id="cb5-25" data-line-number="25"><span class="co">##  Variable proposed Type of step   BICclust Model G   BICdiff Decision</span></a>
<a class="sourceLine" id="cb5-26" data-line-number="26"><span class="co">##                 X2          Add  -822.6398     E 2  11.17931 Accepted</span></a>
<a class="sourceLine" id="cb5-27" data-line-number="27"><span class="co">##                 X1          Add -1482.8408   VEV 2  85.19530 Accepted</span></a>
<a class="sourceLine" id="cb5-28" data-line-number="28"><span class="co">##                 X3          Add -2047.7064   EEV 2 -14.91130 Rejected</span></a>
<a class="sourceLine" id="cb5-29" data-line-number="29"><span class="co">##                 X1       Remove  -822.6398     E 2  85.19530 Rejected</span></a>
<a class="sourceLine" id="cb5-30" data-line-number="30"><span class="co">## </span></a>
<a class="sourceLine" id="cb5-31" data-line-number="31"><span class="co">## Selected subset: X2, X1</span></a></code></pre></div>
</div>
<div id="simulated-no-clustering-data-example" class="section level2">
<h2 class="hasAnchor">
<a href="#simulated-no-clustering-data-example" class="anchor"></a>Simulated no-clustering data example</h2>
<p>In this example we simulate a dataset on ten dimensions with no clustering. It is shown that model-based clustering on all the variables yield the wrong conclusion that 2 clusters are present, but after subset selection the Gaussian finite mixture model correctly select a single cluster solution.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">n &lt;-<span class="st"> </span><span class="dv">200</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2">p &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3">mu &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>,p)</a>
<a class="sourceLine" id="cb6-4" data-line-number="4">sigma1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.5</span>,<span class="fl">0.5</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb6-5" data-line-number="5">sigma2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="fl">1.5</span>,<span class="op">-</span><span class="fl">0.7</span>,<span class="op">-</span><span class="fl">0.7</span>,<span class="fl">1.5</span>),<span class="dv">2</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb6-6" data-line-number="6">sigma &lt;-<span class="st"> </span>Matrix<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/Matrix/topics/bdiag">bdiag</a></span>(sigma1, sigma2, <span class="kw">diag</span>(<span class="dv">6</span>))</a>
<a class="sourceLine" id="cb6-7" data-line-number="7"><span class="kw">set.seed</span>(<span class="dv">12345</span>)</a>
<a class="sourceLine" id="cb6-8" data-line-number="8">X &lt;-<span class="st"> </span>MASS<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/MASS/topics/mvrnorm">mvrnorm</a></span>(n, mu, sigma)</a>
<a class="sourceLine" id="cb6-9" data-line-number="9"><span class="kw">colnames</span>(X) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">"X"</span>, <span class="dv">1</span><span class="op">:</span>p)</a>
<a class="sourceLine" id="cb6-10" data-line-number="10"><span class="kw"><a href="http://www.rdocumentation.org/packages/mclust/topics/clPairs">clPairs</a></span>(X)</a></code></pre></div>
<p><img src="clustvarsel_files/figure-html/unnamed-chunk-6-1.png" width="90%" style="display: block; margin: auto;"></p>
<p>Model-based clustering on all the available variables:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">mod &lt;-<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/mclust/topics/Mclust">Mclust</a></span>(X)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="kw">summary</span>(mod<span class="op">$</span>BIC)</a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="co">## Best BIC values:</span></a>
<a class="sourceLine" id="cb7-4" data-line-number="4"><span class="co">##              EII,2       VII,2       EII,3</span></a>
<a class="sourceLine" id="cb7-5" data-line-number="5"><span class="co">## BIC      -5899.073 -5901.88582 -5922.53452</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="co">## BIC diff     0.000    -2.81261   -23.46131</span></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="kw">summary</span>(mod)</a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="co">## ----------------------------------------------------</span></a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="co">## ----------------------------------------------------</span></a>
<a class="sourceLine" id="cb7-11" data-line-number="11"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-12" data-line-number="12"><span class="co">## Mclust EII (spherical, equal volume) model with 2 components:</span></a>
<a class="sourceLine" id="cb7-13" data-line-number="13"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-14" data-line-number="14"><span class="co">##  log.likelihood   n df       BIC       ICL</span></a>
<a class="sourceLine" id="cb7-15" data-line-number="15"><span class="co">##       -2891.255 200 22 -5899.073 -5953.953</span></a>
<a class="sourceLine" id="cb7-16" data-line-number="16"><span class="co">## </span></a>
<a class="sourceLine" id="cb7-17" data-line-number="17"><span class="co">## Clustering table:</span></a>
<a class="sourceLine" id="cb7-18" data-line-number="18"><span class="co">##   1   2 </span></a>
<a class="sourceLine" id="cb7-19" data-line-number="19"><span class="co">##  90 110</span></a></code></pre></div>
<p>Subset selection using forward/backward greedy algorithm:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">(out1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/clustvarsel.html">clustvarsel</a></span>(X, <span class="dt">verbose =</span> <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="co">## ------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="co">## Variable selection for Gaussian model-based clustering</span></a>
<a class="sourceLine" id="cb8-4" data-line-number="4"><span class="co">## Stepwise (forward/backward) greedy search</span></a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">## ------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"><span class="co">## </span></a>
<a class="sourceLine" id="cb8-7" data-line-number="7"><span class="co">##  Variable proposed Type of step   BICclust Model G    BICdiff Decision</span></a>
<a class="sourceLine" id="cb8-8" data-line-number="8"><span class="co">##                 X3          Add  -666.9232     E 2 -4.8472740 Accepted</span></a>
<a class="sourceLine" id="cb8-9" data-line-number="9"><span class="co">##                 X7          Add -1242.8998   EII 2  1.5678544 Accepted</span></a>
<a class="sourceLine" id="cb8-10" data-line-number="10"><span class="co">##                X10          Add -1814.8848   EII 2  1.5172709 Accepted</span></a>
<a class="sourceLine" id="cb8-11" data-line-number="11"><span class="co">##                X10       Remove -1242.8998   EII 2  1.5172709 Rejected</span></a>
<a class="sourceLine" id="cb8-12" data-line-number="12"><span class="co">##                 X6          Add -2390.3224   EII 2  0.6539224 Accepted</span></a>
<a class="sourceLine" id="cb8-13" data-line-number="13"><span class="co">##                 X6       Remove -1814.8848   EII 2  0.6539224 Rejected</span></a>
<a class="sourceLine" id="cb8-14" data-line-number="14"><span class="co">##                 X2          Add -2942.2744   EII 2  0.1214452 Accepted</span></a>
<a class="sourceLine" id="cb8-15" data-line-number="15"><span class="co">##                 X2       Remove -2390.3224   EII 2  0.1214452 Rejected</span></a>
<a class="sourceLine" id="cb8-16" data-line-number="16"><span class="co">##                 X8          Add -3495.9758   EII 2  0.1104619 Accepted</span></a>
<a class="sourceLine" id="cb8-17" data-line-number="17"><span class="co">##                 X8       Remove -2942.2744   EII 2  0.1104619 Rejected</span></a>
<a class="sourceLine" id="cb8-18" data-line-number="18"><span class="co">##                 X9          Add -4081.9212   EII 2 -2.0296117 Rejected</span></a>
<a class="sourceLine" id="cb8-19" data-line-number="19"><span class="co">##                 X8       Remove -2942.2744   EII 2  0.1104619 Rejected</span></a>
<a class="sourceLine" id="cb8-20" data-line-number="20"><span class="co">## </span></a>
<a class="sourceLine" id="cb8-21" data-line-number="21"><span class="co">## Selected subset: X3, X7, X10, X6, X2, X8</span></a>
<a class="sourceLine" id="cb8-22" data-line-number="22"></a>
<a class="sourceLine" id="cb8-23" data-line-number="23"><span class="kw">summary</span>(out1<span class="op">$</span>model)</a>
<a class="sourceLine" id="cb8-24" data-line-number="24"><span class="co"># or</span></a>
<a class="sourceLine" id="cb8-25" data-line-number="25"><span class="co"># mod1 &lt;- Mclust(X[,out1$subset])</span></a>
<a class="sourceLine" id="cb8-26" data-line-number="26"><span class="co"># summary(mod1)</span></a>
<a class="sourceLine" id="cb8-27" data-line-number="27"><span class="co">## ----------------------------------------------------</span></a>
<a class="sourceLine" id="cb8-28" data-line-number="28"><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></a>
<a class="sourceLine" id="cb8-29" data-line-number="29"><span class="co">## ----------------------------------------------------</span></a>
<a class="sourceLine" id="cb8-30" data-line-number="30"><span class="co">## </span></a>
<a class="sourceLine" id="cb8-31" data-line-number="31"><span class="co">## Mclust XII (spherical multivariate normal) model with 1 component:</span></a>
<a class="sourceLine" id="cb8-32" data-line-number="32"><span class="co">## </span></a>
<a class="sourceLine" id="cb8-33" data-line-number="33"><span class="co">##  log.likelihood   n df       BIC       ICL</span></a>
<a class="sourceLine" id="cb8-34" data-line-number="34"><span class="co">##       -1727.188 200  7 -3491.465 -3491.465</span></a>
<a class="sourceLine" id="cb8-35" data-line-number="35"><span class="co">## </span></a>
<a class="sourceLine" id="cb8-36" data-line-number="36"><span class="co">## Clustering table:</span></a>
<a class="sourceLine" id="cb8-37" data-line-number="37"><span class="co">##   1 </span></a>
<a class="sourceLine" id="cb8-38" data-line-number="38"><span class="co">## 200</span></a></code></pre></div>
<p>Note that the final clustering model shown in the <code><a href="../reference/clustvarsel.html">clustvarsel()</a></code> output is EII with 2 mixture components. However, this model has been constrained to have G <span class="math inline">\(\ge\)</span> 2 components because it must be a clustering model. When the final model is fitted on the selected variables without imposing the constraint on G, the BIC correctly indicates a single component model.</p>
<p>Subset selection using backward/forward greedy algorithm:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">(out2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/clustvarsel.html">clustvarsel</a></span>(X, <span class="dt">direction =</span> <span class="st">"backward"</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="co">## ------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb9-3" data-line-number="3"><span class="co">## Variable selection for Gaussian model-based clustering</span></a>
<a class="sourceLine" id="cb9-4" data-line-number="4"><span class="co">## Stepwise (backward/forward) greedy search</span></a>
<a class="sourceLine" id="cb9-5" data-line-number="5"><span class="co">## ------------------------------------------------------ </span></a>
<a class="sourceLine" id="cb9-6" data-line-number="6"><span class="co">## </span></a>
<a class="sourceLine" id="cb9-7" data-line-number="7"><span class="co">##  Variable proposed Type of step  BICclust Model G     BICdiff Decision</span></a>
<a class="sourceLine" id="cb9-8" data-line-number="8"><span class="co">##                 X2       Remove -5346.204   EII 2 -48.0289667 Accepted</span></a>
<a class="sourceLine" id="cb9-9" data-line-number="9"><span class="co">##                 X4       Remove -4696.525   EII 2  -7.1909995 Accepted</span></a>
<a class="sourceLine" id="cb9-10" data-line-number="10"><span class="co">##                 X3       Remove -4032.114   EII 2  -2.3352781 Accepted</span></a>
<a class="sourceLine" id="cb9-11" data-line-number="11"><span class="co">##                 X3          Add -4696.525   EII 2  -2.3352781 Rejected</span></a>
<a class="sourceLine" id="cb9-12" data-line-number="12"><span class="co">##                 X7       Remove -3453.786   EII 2  -1.1967844 Accepted</span></a>
<a class="sourceLine" id="cb9-13" data-line-number="13"><span class="co">##                 X7          Add -4032.114   EII 2  -1.1967844 Rejected</span></a>
<a class="sourceLine" id="cb9-14" data-line-number="14"><span class="co">##                 X8       Remove -2899.545   EII 2  -0.4288443 Accepted</span></a>
<a class="sourceLine" id="cb9-15" data-line-number="15"><span class="co">##                 X8          Add -3453.786   EII 2  -0.4288443 Rejected</span></a>
<a class="sourceLine" id="cb9-16" data-line-number="16"><span class="co">##                 X5       Remove -2308.785   EII 2   1.0712786 Rejected</span></a>
<a class="sourceLine" id="cb9-17" data-line-number="17"><span class="co">##                 X8          Add -3453.786   EII 2  -0.4288443 Rejected</span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18"><span class="co">## </span></a>
<a class="sourceLine" id="cb9-19" data-line-number="19"><span class="co">## Selected subset: X1, X5, X6, X9, X10</span></a>
<a class="sourceLine" id="cb9-20" data-line-number="20"></a>
<a class="sourceLine" id="cb9-21" data-line-number="21"><span class="kw">summary</span>(out2<span class="op">$</span>model)</a>
<a class="sourceLine" id="cb9-22" data-line-number="22"><span class="co">## ----------------------------------------------------</span></a>
<a class="sourceLine" id="cb9-23" data-line-number="23"><span class="co">## Gaussian finite mixture model fitted by EM algorithm </span></a>
<a class="sourceLine" id="cb9-24" data-line-number="24"><span class="co">## ----------------------------------------------------</span></a>
<a class="sourceLine" id="cb9-25" data-line-number="25"><span class="co">## </span></a>
<a class="sourceLine" id="cb9-26" data-line-number="26"><span class="co">## Mclust XII (spherical multivariate normal) model with 1 component:</span></a>
<a class="sourceLine" id="cb9-27" data-line-number="27"><span class="co">## </span></a>
<a class="sourceLine" id="cb9-28" data-line-number="28"><span class="co">##  log.likelihood   n df       BIC       ICL</span></a>
<a class="sourceLine" id="cb9-29" data-line-number="29"><span class="co">##       -1424.072 200  6 -2879.934 -2879.934</span></a>
<a class="sourceLine" id="cb9-30" data-line-number="30"><span class="co">## </span></a>
<a class="sourceLine" id="cb9-31" data-line-number="31"><span class="co">## Clustering table:</span></a>
<a class="sourceLine" id="cb9-32" data-line-number="32"><span class="co">##   1 </span></a>
<a class="sourceLine" id="cb9-33" data-line-number="33"><span class="co">## 200</span></a></code></pre></div>
<p>Although the selected subset of variables is different from that obtained using forward greedy search, the same comments outlined previously apply here too.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#simulated-clustering-data-example">Simulated clustering data example</a></li>
      <li><a href="#simulated-no-clustering-data-example">Simulated no-clustering data example</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Nema Dean, Adrian E. Raftery, <a href="http://www.stat.unipg.it/luca">Luca Scrucca</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
